<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Pagination :: Learn Node.js by Alex Kluew</title>
    <link rel="canonical" href="https://course.learnnodejs.dev/main/1.5/pagination.html">
    <link rel="prev" href="maps.html">
    <link rel="next" href="users.html">
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-173618647-1"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','UA-173618647-1')</script>
  </head>
  <body class="article">
<script async data-uid="b7a10c8563" src="https://wondrous-experimenter-4427.ck.page/b7a10c8563/index.js"></script>
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://course.learnnodejs.dev">Learn Node.js by Alex Kluew</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://gumroad.com/l/javascript" target="_blank">Buy on Gumroad</a>
        <a class="navbar-item" href="https://leanpub.com/learnnodejs" target="_blank">Buy on LeanPub</a>
        <a class="navbar-item" href="https://twitter.com/alexkluew_dev">
          <span class="icon">
            <svg aria-hidden="true" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 512 512">
              <path fill="#57aaee"
                d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z">
              </path>
            </svg>
          </span>
        </a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="main" data-version="1.5">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Learn Node.js</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="sequelize.js.html">Database</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="seo.html">SEO</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="maps.html">Maps</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="pagination.html">Pagination</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="users.html">Authentication and Authorization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="deployment.html">Deployment</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Learn Node.js</span>
    <span class="version">1.5</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Learn Node.js</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">1.5</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Learn Node.js</a></li>
    <li><a href="pagination.html">Pagination</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/learnnodejsca/learnnodejs/edit/master/main/modules/ROOT/pages/pagination.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Pagination</h1>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In this chapter I walk you through a small project that you can use to add pagination to any route that you like in your projects.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/pagination-screen.png" alt="Residences pagination feature">
</div>
<div class="title">Figure 1. Residences pagination feature</div>
</div>
<div class="paragraph">
<p>The goal of this chapter is to show how one can go from a table UI showing lots of data points to a paginated table UI. To do this, I needed to check if my database supports <code>offset</code> and <code>limit</code> properties. What followed, was finding that , both, PostgresSQL and Sequelize support these parameters. I needed to create the code.</p>
</div>
<div class="paragraph">
<p>I did this by adding a new query in the url <code>?page=1</code> for the <code>/residences</code> page which indicates which page the user is browsing, starting with page 0. The default behaviour of this simple pagination feature is to browse the residences list one page at a time. If one were to try this feature, I think one would notice that either search or view map features offer better performance and quicker find-ability.</p>
</div>
<div class="paragraph">
<p>I made a deliberate decision when I opted to add <code>?page=1</code> to <code>/residences</code>. Thus, the proper url was now <code>/residences?page=1</code> and not just <code>/residences</code>.</p>
</div>
<div class="paragraph">
<p>This decision allows me to make the following code using the query.page property of the req object of the /residences route handler. In other words, here is what the code looks like :</p>
</div>
<div class="listingblock">
<div class="title">./routes/residences.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">...
router.get('/', async (req, res, next) =&gt; {
  try {
    const currentPage =
      req.query.page &amp;&amp; Number(req.query.page) &gt; 0 ? Number(req.query.page) : 0;
    const offset = currentPage * 25;
    const prevPage = currentPage - 1 &gt;= 0 ? currentPage - 1 : 0;
    const nextPage = currentPage + 1;
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code above is setting up the values of previous page, current page, and next page variable. In addition, I wanted my pages to contain 25 elements. So, my offset was calculate simply by the position of the <code>?page=1</code> parameter being multiplied by 25. In the code, I also check for the boundary of zero and if the value is below zero, I simply set the whatever value to zero. In my current code, we cannot have negative pages.</p>
</div>
<div class="paragraph">
<p>These parameters are then just passed to the page template. In the page template, they simply set the appropriate value for the previous and next pages. Please notice that in the following code I also calculate the number of total pages with the anticipation of future features that links to the last page.</p>
</div>
<div class="listingblock">
<div class="title">./routes/residences.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">...
const residences = await Residence.findAndCountAll({
  offset: offset,
  limit: 25
});
const { count, rows } = residences;
const totalPages = count / 25;
const page = {
  prevPage,
  currentPage,
  nextPage,
  totalPages
};
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>What comes next is simply passing all of this data down to the template like so</p>
</div>
<div class="listingblock">
<div class="title">./routes/residences.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">...
res.render('residences/index', {
  title: `Residences - Elderoost`,
  residences: rows,
  page: page
});
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then I needed to glue all of the pieces together in the handlebarsjs template in the following way</p>
</div>
<div class="listingblock">
<div class="title">./views/residences/index.hbs</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">...
{{#if page}}
&lt;a href="/residences?page={{page.prevPage}}" class="main__wrapper__link"&gt;Previous&lt;/a&gt;
&lt;a href="/residences?page={{page.nextPage}}" class="main__wrapper__link"&gt;Next&lt;/a&gt;
{{/if}}
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>and when I refreshed my <code>/residences?page=1</code> route I got my pagination function at the bottom of the screen just like in the chapterâ€™s picture.</p>
</div>
<nav class="pagination">
  <span class="prev"><a href="maps.html">Maps</a></span>
  <span class="next"><a href="users.html">Authentication and Authorization</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
